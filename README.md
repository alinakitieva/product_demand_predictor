# Прогнозирование спроса на товары собственного производства для гипермаркета "Лента"
## Описание проекта

### ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ:

- Бизнес цель: разработать прогностический инструмент в помощь планирования приготовления товаров собственного производства (кухня, пекарня и пр.).
- Побочная бизнес цель: при получении точных прогнозов ожидается снижение объема упущенных продаж, уменьшение числа списаний по сроку годности.
- Техническая задача: разработать пайплайн прогноза спроса товаров категории "Собственное производство" в штуках и построить прогноз на 14 дней в будущее.

**Финальный результат работы пайплайна** - это отчёт/таблица, в которой строим прогноз спроса по товарам, в каком количестве необходимо их приготовить в каждом ТК, для повышения доступности товаров на полке, для увеличения продаж

**Метрики точности**: WAPE формула 
```python
def wape(y_true: np.array, y_pred: np.array):
  return np.sum(np.abs(y_true-y_pred))/np.sum(np.abs(y_true)).
```
## Итоги
* Для решения задачи прогнозирования спроса была использована модель градиентного
бустинга Light Gradient Boosted Machine.
* Для подбора оптимальных гиперпараметров был применен RandomizedSearchCV с кросс-валидацией при помощи метода rolling_time_series_split.
* Лучший показатель метрики WAPE на обучащей выборке равен 0.5.
* WAPE на тестовой выборке равен 0.55, что сопоставимо с результатом при обучении.
* Гиперпараметры лучшей модели:
'random_state': 42,
 'num_leaves': 127,
 'min_data_in_leaf': 50,
 'lambda_l2': 1,
 'lambda_l1': 0

## Анализ результатов
Наиболее важный признак - показатель спроса предыдущего дня и день недели. Также в топе самых влиятельных признаков, в порядке убывания, медианный показатель спроса за все предыдущие дни, показатель спроса двумя днями ранее, день года, скользящее среднее за 7 дней, день недели и наименование товара.

Самыми малозначимыми признаками оказались признаки выходного и рабочего дня, кластер магазина, номер недели, номер месяца, а также признак выходного дня.
